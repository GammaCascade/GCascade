(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     91985,       2111]
NotebookOptionsPosition[     86492,       1973]
NotebookOutlinePosition[     86975,       1992]
CellTagsIndexPosition[     86932,       1989]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["GCascade Tutorial Notebook", "Title",
 CellChangeTimes->{{3.724775379256321*^9, 3.7247753808814926`*^9}, {
   3.724775412603834*^9, 3.724775431711986*^9}, {3.725379608768941*^9, 
   3.725379609865661*^9}, 3.7314477507170525`*^9},
 CellID->99529794,ExpressionUUID->"da265509-a8d4-4324-8bfe-425a1de32681"],

Cell[CellGroupData[{

Cell["\<\
Welcome to the GCascade tutorial notebook. This notebook aims to walk through \
the basic functionality of the GCascade gamma-ray propagation package \
assuming very little prior knowledge of Mathematica. For information about \
the specific physics models used by the code, please refer to the \
documentation. To use this notebook simply follow the instructions, executing \
cells containing code by pressing (Shft + Enter).\
\>", "Subchapter",
 CellChangeTimes->{{3.724775455221959*^9, 3.7247756677768707`*^9}, {
   3.7250383332322683`*^9, 3.7250383556201296`*^9}, {3.725038389546157*^9, 
   3.7250384653423004`*^9}, {3.725040767393932*^9, 3.7250408543472433`*^9}, 
   3.725040895159438*^9, {3.725051511845199*^9, 3.725051527117547*^9}, {
   3.725301358215523*^9, 3.7253013923037243`*^9}, {3.7314477508393784`*^9, 
   3.7314477509496717`*^9}, 3.731634769192498*^9},
 CellID->169207782,ExpressionUUID->"506d7f65-6c60-49bb-b6b2-ea2c9ca444b2"],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Importing and Setting ", "Chapter"],
 StyleBox["Up", "Chapter"],
 StyleBox[" The Package", "Chapter"]
}], "Section",
 CellChangeTimes->{{3.7250376947975836`*^9, 3.725037791968221*^9}},
 CellID->95071794,ExpressionUUID->"d31c9ffc-8199-445a-895c-21c1dd331ea7"],

Cell[CellGroupData[{

Cell["\<\
The following code adds the location of the package ( .wl file) to your \
\"$Path\" so that the Mathematica kernel knows where to find it when you try \
to import the package.  Note that the \[OpenCurlyDoubleQuote];\
\[CloseCurlyDoubleQuote] at the end of the expression prevents Mathematica \
from returning the output of a given command.  \
\>", "Subsection",
 CellChangeTimes->{{3.7250374948061934`*^9, 3.7250376374386663`*^9}, 
   3.725037935663986*^9, {3.725038610161211*^9, 3.725038613269878*^9}, 
   3.731447806266756*^9},
 CellID->4253156,ExpressionUUID->"0d528ea2-49ee-4558-8bd6-ce2aac46b28f"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"$Path", ",", " ", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}], ";"}], 
  "Input"]], "Input",
 CellChangeTimes->{
  3.725301422333828*^9, {3.725750274980956*^9, 3.7257502756651025`*^9}, {
   3.7257503094498034`*^9, 3.725750314129491*^9}, {3.7258156136551604`*^9, 
   3.7258156340975513`*^9}, {3.725827223931425*^9, 3.7258272328385777`*^9}, 
   3.726850353087145*^9},
 CellLabel->"In[1]:=",
 CellID->9425827,ExpressionUUID->"f6e72b46-c8f6-4a8e-980e-f164c99da359"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Next, we import the package using the command short-hand \
\[OpenCurlyDoubleQuote]",
 StyleBox["<<", "Input"],
 "\[CloseCurlyDoubleQuote]. When the command is executed, the code within the \
package file is run in order to set up the internal functions and variables \
which are then made available in this notebook. "
}], "Subsection",
 CellChangeTimes->{{3.72437562808994*^9, 3.724375676848176*^9}, 
   3.7243799695814533`*^9, 3.7244295376723766`*^9, {3.7244366197776213`*^9, 
   3.7244366943176966`*^9}, {3.725037254997822*^9, 3.7250373243605127`*^9}, {
   3.725037366570842*^9, 3.7250373666177235`*^9}, 3.7250374850556364`*^9, {
   3.7250376471603837`*^9, 3.7250376589703107`*^9}, {3.7250379173002176`*^9, 
   3.7250380357108254`*^9}, {3.725038629024165*^9, 3.725038639468829*^9}, {
   3.725301505923707*^9, 3.725301506207963*^9}},
 CellID->476640968,ExpressionUUID->"b03fa9bc-ed56-4b40-86c9-50c8c7eb6a91"],

Cell[BoxData[
 RowBox[{"<<", "GCascadeV2.wl"}]], "Input",
 CellChangeTimes->{{3.7243766927291684`*^9, 3.7243767022145443`*^9}, {
   3.724377153532448*^9, 3.724377180632006*^9}, {3.724432867946347*^9, 
   3.7244328687810817`*^9}, {3.724433081085376*^9, 3.724433081897493*^9}, {
   3.7244331505209575`*^9, 3.7244331506928444`*^9}, {3.7244331901007204`*^9, 
   3.7244331902417865`*^9}, {3.724433292886937*^9, 3.724433292965435*^9}, {
   3.724433509489854*^9, 3.724433542759017*^9}, {3.724434257330654*^9, 
   3.7244342800745764`*^9}, {3.7244344956584077`*^9, 3.7244344974322166`*^9}, 
   3.7244354121771584`*^9, {3.724435896863796*^9, 3.7244358991692486`*^9}, {
   3.724436700149818*^9, 3.724436773131342*^9}, {3.7250379151584764`*^9, 
   3.725037941617734*^9}, 3.7250380478568125`*^9, {3.7252887891469517`*^9, 
   3.725288789647003*^9}, {3.725299283456549*^9, 3.7252992839495926`*^9}, {
   3.7253821191541862`*^9, 3.72538211924087*^9}, 3.725810638417597*^9, {
   3.7298913976748204`*^9, 3.72989139855534*^9}, {3.729893557562604*^9, 
   3.7298935578899965`*^9}, {3.7298942232829943`*^9, 3.729894224227029*^9}, {
   3.731341644361763*^9, 3.731341644866104*^9}, {3.7313449373632493`*^9, 
   3.731344937470559*^9}, {3.7314126999753847`*^9, 3.731412702365741*^9}, {
   3.7314128168810196`*^9, 3.7314128185193844`*^9}, {3.731412889547529*^9, 
   3.7314128898653746`*^9}, {3.7356888062048855`*^9, 3.735688806679813*^9}},
 CellLabel->"In[2]:=",
 CellID->26431907,ExpressionUUID->"8057e53b-7388-4904-ab2c-f9c4f3fa4cd5"]
}, Open  ]]
}, Open  ]],

Cell[TextData[StyleBox["Propagating Gamma-Rays", "Chapter"]], "Section",
 CellChangeTimes->{{3.7250385749957128`*^9, 3.725038588042203*^9}, {
  3.725038781971844*^9, 3.725038783550283*^9}},
 CellID->256563983,ExpressionUUID->"1516cf4e-a82f-41f7-ae3a-8277cdefb687"],

Cell[CellGroupData[{

Cell["Injected Spectrum", "Section",
 CellChangeTimes->{{3.7250388363018703`*^9, 3.725038841349275*^9}},
 CellID->43342969,ExpressionUUID->"5dc9e800-2eec-4c84-b09d-d55aadd46a5d"],

Cell[CellGroupData[{

Cell[TextData[{
 "The central input for ",
 StyleBox["GCascade",
  FontWeight->"Bold"],
 " is the injected spectrum. Formatting this array correctly is vital. \
Injected spectra should be lists of real numbers. The injected spectrum must \
be 300 members in length, i.e. as long as the list \[OpenCurlyDoubleQuote]",
 StyleBox["energies", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote]. The values in the injected spectrum are expected \
to be values of the injected differential flux spectrum evaluated at certain \
energies given by the list, \[OpenCurlyDoubleQuote]",
 StyleBox["energies", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote]. \[OpenCurlyDoubleQuote]",
 StyleBox["energies", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote] is a list of logarithmically spaced energies from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "1"}]], " ", "GeV", " ", "to", " ", 
    SuperscriptBox["10", "12"], "GeV"}], TraditionalForm]],ExpressionUUID->
  "1669c3ac-71e6-46f6-b5f7-3a696f014fac"],
 ", available from the GCascade package.  As an example, below, the variable \
\[OpenCurlyDoubleQuote]",
 StyleBox["injSpectrum", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote] is assigned a list which is made using the \
function \[OpenCurlyDoubleQuote]",
 StyleBox["Table", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote]. Table takes in two inputs, a function, ",
 StyleBox["f(i)", "Input",
  FontSize->16,
  FontWeight->"Plain"],
 StyleBox[",", "Input"],
 StyleBox[" ", "InlineFormula"],
 " and an iterator, ",
 StyleBox["{i,i_start,i_final, di}", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 " , and returns a list, ",
 StyleBox["{ ", "Input",
  FontSize->16],
 StyleBox["f[i_start],f[i_start + di],...,f[i_final] }", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 ". We use \[OpenCurlyDoubleQuote]",
 StyleBox["Table", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] to generate a list of the values of the function \
\[OpenCurlyDoubleQuote]",
 StyleBox["cutoffPowerLaw", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote] evaluated at the i-th member of the gamma-ray \
energy list, \[OpenCurlyDoubleQuote]",
 StyleBox["energiesGamma[[i]]", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote]. The function \[OpenCurlyDoubleQuote]",
 StyleBox[Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{
     StyleBox["cutoffPowerLaw",
      FontWeight->"Bold"], 
     StyleBox["[",
      FontWeight->"Bold"], 
     StyleBox[
      RowBox[{"E", ",", "\[CapitalGamma]", ",", 
       SubscriptBox["E", "cutoff"], ",", "A"}],
      FontWeight->"Bold"], "]"}],
    FontSize->18], TraditionalForm]], "Input",
  FontSize->16,
  FontWeight->"Bold",ExpressionUUID->"d293926a-82e5-4637-9663-8ee54a13f621"], 
  "InlineFormula"],
 "\[CloseCurlyDoubleQuote] is a function that returns the value of an \
exponentially cutoff power law;",
 StyleBox[" ", "InlineFormula"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["dN", "dE"], "=", 
    RowBox[{"A", "\[Times]", 
     SuperscriptBox["E", 
      RowBox[{"-", "\[CapitalGamma]"}]], 
     RowBox[{"exp", "[", 
      FractionBox[
       RowBox[{"-", "E"}], 
       SubscriptBox["E", "cutoff"]], "]"}]}]}], TraditionalForm]], "Input",
  FontSize->14,
  FontWeight->"Bold",ExpressionUUID->"f4fc672e-5d6d-4786-87c3-61bbcbb963dc"], 
  "InlineFormula"],
 StyleBox[". Here, we choose to create a flat spectrum (i.e. \[CapitalGamma] \
= 2) power law with a cutoff energy of ", "InlineFormula"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["10", "22"], "eV"}], TraditionalForm]],ExpressionUUID->
  "5ef5258a-aa12-4d11-93c8-636c5a08e328"],
 " and a normalization of A = ",
 Cell[BoxData[
  FormBox[
   RowBox[{"3.12", " ", 
    SuperscriptBox["x10", "42"], 
    SuperscriptBox["GeV", " "], 
    SuperscriptBox["s", 
     RowBox[{"-", "1"}]]}], TraditionalForm]],ExpressionUUID->
  "45d8cc12-39bf-408d-b02d-cbcb6a767709"],
 "."
}], "Subsection",
 CellChangeTimes->{{3.7250388632501087`*^9, 3.725039468597805*^9}, {
  3.7250395076538506`*^9, 3.72503954927892*^9}, {3.725039588602466*^9, 
  3.7250397265596952`*^9}, {3.7250397603358994`*^9, 3.7250401997670965`*^9}, {
  3.725040247823224*^9, 3.7250404604025764`*^9}, {3.72504057844232*^9, 
  3.725040672703782*^9}, {3.7250407329796443`*^9, 3.7250407470190277`*^9}, {
  3.7250512846447825`*^9, 3.7250512855042195`*^9}, {3.7253015332624025`*^9, 
  3.7253015707301064`*^9}, {3.725301646698636*^9, 3.725301816850806*^9}, {
  3.7314477510660067`*^9, 3.7314477511983323`*^9}, {3.7314479384183035`*^9, 
  3.7314479391963725`*^9}, {3.7314481011459856`*^9, 3.7314481149055734`*^9}, {
  3.731448609030835*^9, 3.7314486521775584`*^9}, {3.7314487012470307`*^9, 
  3.731448713434437*^9}, {3.736551411083213*^9, 3.7365514114003654`*^9}, {
  3.73655729818155*^9, 3.736557360428014*^9}, {3.7373101280888557`*^9, 
  3.7373101280898724`*^9}},
 CellID->247095694,ExpressionUUID->"1d4eb0a3-2358-404f-b181-7623bf1aea36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"injSpectrum", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"cutoffPowerLaw", "[", 
       RowBox[{
        RowBox[{"energies", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "2.0", ",", 
        SuperscriptBox["10", "13"], ",", 
        RowBox[{"(", 
         RowBox[{"3.12", "*", 
          SuperscriptBox["10", "42"]}], ")"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.725042979184956*^9, 3.725042981012883*^9}, {
   3.731104843610841*^9, 3.7311048649242935`*^9}, {3.7311061863116274`*^9, 
   3.7311061888321266`*^9}, {3.731106321487816*^9, 3.731106335646261*^9}, {
   3.7313425505402346`*^9, 3.73134256162571*^9}, {3.731345153819534*^9, 
   3.731345155168205*^9}, 3.7314124253501735`*^9, {3.7314130217590904`*^9, 
   3.731413049467747*^9}, {3.731448444938523*^9, 3.7314484735656404`*^9}, {
   3.7358288268292933`*^9, 3.735828831763542*^9}, {3.7358443147520075`*^9, 
   3.7358443181193933`*^9}, {3.7358722829699636`*^9, 
   3.7358722865883284`*^9}, {3.7365182834288025`*^9, 
   3.7365182864978013`*^9}, {3.736552721668792*^9, 3.7365527271700735`*^9}, {
   3.7365573684565315`*^9, 3.7365573768799963`*^9}, {3.7365575597956114`*^9, 
   3.73655755996815*^9}, 3.7373100059755588`*^9, {3.7373100543132324`*^9, 
   3.737310184822071*^9}, {3.7373128523925934`*^9, 3.7373128559345975`*^9}, {
   3.7374667786726627`*^9, 3.7374667789226356`*^9}},
 CellLabel->"In[28]:=",
 CellID->226848316,ExpressionUUID->"0d645c86-0079-4ccb-9a18-be60e3953066"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "This injected spectrum can be plotted as an energy spectrum using the \
\[OpenCurlyDoubleQuote]",
 StyleBox["specPlot", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] function available in GCascade. The \
\[OpenCurlyDoubleQuote]",
 StyleBox["specPlot", "Input",
  FontSize->18],
 "\[CloseCurlyDoubleQuote] functions takes in a spectrum formatted as above \
and returns a primitive scatter plot of the energy spectrum, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["E", "2"], 
     FractionBox["dN", "dE"]}]}], TraditionalForm]]],
 ").  The axes on the returned plot are given in units of",
 StyleBox[" ", "Input"],
 Cell[BoxData[
  FormBox["GeV", TraditionalForm]]],
 " and GeV energy flux."
}], "Subsection",
 CellChangeTimes->{{3.72504153273925*^9, 3.725041556804247*^9}, {
   3.725042754584958*^9, 3.72504277697338*^9}, {3.725042811100725*^9, 
   3.725042931901696*^9}, {3.7250429708202333`*^9, 3.7250430434956713`*^9}, {
   3.7250434410691338`*^9, 3.725043447196072*^9}, {3.7250434902875867`*^9, 
   3.7250435304787207`*^9}, {3.725301892935851*^9, 3.7253019350774665`*^9}, 
   3.7314477513266735`*^9},
 CellID->113528703],

Cell[BoxData[
 RowBox[{"injectedPlot", "=", 
  RowBox[{"specPlot", "[", "injSpectrum", "]"}]}]], "Input",
 CellChangeTimes->{{3.7250429371819625`*^9, 3.7250429528966084`*^9}, {
  3.7252993999024067`*^9, 3.7252994048189964`*^9}, {3.7252999940945406`*^9, 
  3.7252999946738615`*^9}, {3.7314130534292803`*^9, 3.7314130613363047`*^9}, {
  3.737467167790279*^9, 3.737467169180588*^9}},
 CellLabel->"In[4]:=",
 CellID->92325888,ExpressionUUID->"ca0ff386-42a9-404a-a96f-61698ee85911"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Attenuation", "Section",
 CellChangeTimes->{{3.725041341585208*^9, 3.725041343871314*^9}},
 CellID->297973296],

Cell[CellGroupData[{

Cell[TextData[{
 "Suppose you want to calculate the resulting spectrum due to attenuation of \
some point source spectrum during cosmological transport. To simply attenuate \
the injected spectrum, you can use the \[OpenCurlyDoubleQuote]",
 StyleBox["GAttenuate", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote] function. \[OpenCurlyDoubleQuote]",
 StyleBox["GAttenuate[injSpectra,zStart]", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote] is a function which takes in a gamma-ray injected \
spectrum, and starting z. This function produces an attenuated differential \
spectrum, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["dN", 
      SubscriptBox["dE", "\[Gamma]"]], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["GeV", 
        RowBox[{"-", "1"}]], 
       SuperscriptBox["cm", 
        RowBox[{"-", "2"}]], " ", 
       SuperscriptBox["s", 
        RowBox[{"-", "1"}]]}], ")"}]}], ")"}], TraditionalForm]],
  ExpressionUUID->"a837121a-893c-424b-b696-068b9395bb9a"],
 " , without including cascade evolution but taking into account cosmological \
energy shifts. The injected spectrum should be formatted as an array of \
values of differential flux ",
 Cell[BoxData[
  FormBox["(", TraditionalForm]],ExpressionUUID->
  "4a3ef052-33a9-4d77-a6bc-c5c8807e8494"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["dN", 
     SubscriptBox["dE", "\[Gamma]"]], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["GeV", 
       RowBox[{"-", "1"}]], " ", 
      SuperscriptBox["cm", 
       RowBox[{"-", "2"}]], " ", 
      SuperscriptBox["s", 
       RowBox[{"-", "1"}]]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "e4e81735-8f4b-4e9f-a83b-71db410aaf5c"],
 ") evaluated at the energies given by the array, \[OpenCurlyDoubleQuote]",
 StyleBox["energies", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote]. Below, the variable, \[OpenCurlyDoubleQuote]",
 StyleBox["attenuatedSpectrum", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote] is assigned the output list of the function \
\[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeAttenuate", "Input",
  FontSize->16,
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote]. \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeAttenuate", "Input",
  FontFamily->"Source Code Pro",
  FontSize->16,
  FontWeight->"Bold"],
 "\[CloseCurlyDoubleQuote] is passed a differential spectrum ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    FractionBox["dN", 
     SubscriptBox["dE", "\[Gamma]"]], ")"}], TraditionalForm]],
  ExpressionUUID->"91d8ed9b-d520-4baa-9b07-08af601ee2e6"],
 " which is ",
 StyleBox["injSpectrum", "Input",
  FontSize->16],
 StyleBox[".", "Input",
  FontFamily->"Gill Sans MT",
  FontSize->18,
  FontWeight->"Plain"],
 StyleBox[" ", "Input",
  FontFamily->"Gill Sans MT",
  FontSize->18,
  FontWeight->"Bold"],
 StyleBox["The injected spectrum is then propagated from Z = 0.001. The \
function, ", "Input",
  FontFamily->"Gill Sans MT",
  FontSize->16,
  FontWeight->"Plain"],
 StyleBox["\[OpenCurlyDoubleQuote]",
  FontFamily->"Gill Sans MT",
  FontSize->16,
  FontWeight->"Plain"],
 StyleBox["AbsoluteTiming", "Input",
  FontFamily->"Source Code Pro",
  FontSize->16,
  FontWeight->"Bold"],
 StyleBox["\[CloseCurlyDoubleQuote] returns the amount of time it took your \
computer to complete the last command, in this case evaluating, \
\[OpenCurlyDoubleQuote]",
  FontFamily->"Gill Sans MT",
  FontSize->16,
  FontWeight->"Plain"],
 StyleBox["GCascadeAttenuate", "Input",
  FontFamily->"Source Code Pro",
  FontSize->16,
  FontWeight->"Bold"],
 StyleBox["\[CloseCurlyDoubleQuote], out to ",
  FontFamily->"Gill Sans MT",
  FontSize->16,
  FontWeight->"Plain"],
 StyleBox["Z = 0.001. Note that computational time is approximately linear in \
starting z for all functions starting with ", "Input",
  FontFamily->"Gill Sans MT",
  FontSize->16,
  FontWeight->"Plain"],
 StyleBox["\[OpenCurlyDoubleQuote]",
  FontFamily->"Gill Sans MT",
  FontSize->16,
  FontWeight->"Plain"],
 StyleBox["GCascade", "Input",
  FontFamily->"Source Code Pro",
  FontSize->16,
  FontWeight->"Bold"],
 StyleBox["\[CloseCurlyDoubleQuote]",
  FontFamily->"Gill Sans MT",
  FontSize->16,
  FontWeight->"Plain"],
 StyleBox[".", "Input",
  FontFamily->"Gill Sans MT",
  FontSize->16,
  FontWeight->"Plain"]
}], "Subsection",
 CellChangeTimes->{{3.7250413616263323`*^9, 3.725041422814145*^9}, {
   3.7250435514510345`*^9, 3.725043571630541*^9}, {3.725043645012355*^9, 
   3.72504366497206*^9}, {3.725043695617957*^9, 3.725043796269067*^9}, {
   3.7250438458285823`*^9, 3.725043925613713*^9}, {3.725043966623836*^9, 
   3.7250440103334866`*^9}, {3.7250440443258224`*^9, 3.725044139909415*^9}, {
   3.7250505054266157`*^9, 3.725050629355074*^9}, {3.725050813455267*^9, 
   3.72505083367579*^9}, {3.7250508855545835`*^9, 3.725051106596771*^9}, {
   3.725051154134431*^9, 3.7250512266847167`*^9}, {3.725286321992442*^9, 
   3.7252863943906393`*^9}, {3.7253019728632755`*^9, 3.725302057671161*^9}, {
   3.7314131549033575`*^9, 3.7314131794546385`*^9}, 3.731449295783868*^9, {
   3.751164946321498*^9, 3.7511650253323193`*^9}, {3.751165118162408*^9, 
   3.751165135147047*^9}, {3.751165360478271*^9, 3.751165393129842*^9}, 
   3.7511655297359943`*^9, {3.751165610469295*^9, 3.75116577079191*^9}, {
   3.7511658009914722`*^9, 3.751165801208329*^9}, {3.751165836755527*^9, 
   3.751165873636251*^9}, {3.751166274082322*^9, 3.751166274442561*^9}, {
   3.7511663055001698`*^9, 3.751166322271266*^9}},
 CellID->22936097,ExpressionUUID->"77684371-9601-4f15-a172-4f3a6dfe6f1f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"attenuatedSpectrum", "=", 
    RowBox[{"GCascadeAttenuate", "[", 
     RowBox[{"injSpectrum", ",", "0.001"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"attenuatedSpectrumPlot", "=", 
  RowBox[{"specPlot", "[", "attenuatedSpectrum", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7250441505316086`*^9, 3.7250441922157307`*^9}, {
   3.7250445983914747`*^9, 3.725044609740526*^9}, {3.7250513457096996`*^9, 
   3.7250513618380384`*^9}, {3.72505651425535*^9, 3.7250565166770134`*^9}, 
   3.7250565617911453`*^9, {3.7251266500031776`*^9, 3.725126665629589*^9}, {
   3.7252877500438457`*^9, 3.7252877506376576`*^9}, {3.7252877957209616`*^9, 
   3.7252878176138735`*^9}, {3.725287858860445*^9, 3.725287867611821*^9}, {
   3.725300002966832*^9, 3.7253000642189293`*^9}, {3.725300825542116*^9, 
   3.7253008266319284`*^9}, 3.72576629672971*^9, {3.7258099974622116`*^9, 
   3.72581003965847*^9}, {3.7258101387641582`*^9, 3.7258101942568274`*^9}, {
   3.7258102928731985`*^9, 3.725810293281285*^9}, {3.725810365344023*^9, 
   3.7258103654934216`*^9}, {3.725810468639865*^9, 3.7258104691261587`*^9}, {
   3.726855764590152*^9, 3.7268557652937813`*^9}, {3.726856175662981*^9, 
   3.726856186062049*^9}, {3.726946067493178*^9, 3.7269460740875206`*^9}, 
   3.726946256082839*^9, {3.7269462897122*^9, 3.7269463210622563`*^9}, 
   3.726946354902505*^9, {3.726946434584944*^9, 3.726946444206645*^9}, 
   3.7269474088175383`*^9, 3.7269483134141464`*^9, {3.7299126189133043`*^9, 
   3.7299126509760394`*^9}, {3.72991308184824*^9, 3.7299130848108325`*^9}, 
   3.731157345136074*^9, {3.731157490159683*^9, 3.7311575613289175`*^9}, {
   3.731342743242218*^9, 3.7313427462662587`*^9}, {3.7313451863219557`*^9, 
   3.731345189876407*^9}, {3.7313452235599694`*^9, 3.731345224113441*^9}, {
   3.73141306789579*^9, 3.7314130985462694`*^9}, 3.7314485338619657`*^9, 
   3.735844132042153*^9, {3.736553347712222*^9, 3.736553348058297*^9}, 
   3.751163483557233*^9, {3.7511638091207867`*^9, 3.751163938393681*^9}, 
   3.751164048420925*^9, {3.7511641858863*^9, 3.751164198016148*^9}, 
   3.751164741118937*^9, {3.7511647732066383`*^9, 3.751164773448927*^9}, {
   3.751165037335339*^9, 3.7511650775693007`*^9}, {3.7511651089325457`*^9, 
   3.751165109656705*^9}},
 CellLabel->"In[38]:=",
 CellID->370012094,ExpressionUUID->"ddf2b636-0562-49b6-8fd6-522a2cfb47d8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["EM Cascades From a Point Source ", "Section",
 CellChangeTimes->{{3.7250514615193005`*^9, 3.7250514691919875`*^9}, {
  3.725304414332052*^9, 3.725304429293392*^9}},
 CellID->243349693],

Cell[CellGroupData[{

Cell[TextData[{
 "Now, lets consider the cascade development during transport of the \
gamma-rays from the point source discussed in the example above. To calculate \
the spectrum after cascade development during transport from a point source, \
you can use the \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadePoint", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote].  \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadePoint[injected spectrum, source distance (Z)]", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] is a function which takes in a gamma-ray injected \
spectrum, and source distance. \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadePoint\[CloseCurlyDoubleQuote]", "Input",
  FontSize->16],
 " produces a cascaded differential spectrum, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["dN", "dE"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["GeV", 
        RowBox[{"-", "1"}]], 
       SuperscriptBox["cm", 
        RowBox[{"-", "2"}]], " ", 
       SuperscriptBox["s", 
        RowBox[{"-", "1"}]]}], ")"}]}], ")"}], TraditionalForm]],
  ExpressionUUID->"d838ed15-f7cf-42e7-ae60-c08084899e54"],
 ", taking into account cosmological and electromagnetic energy losses. The \
injected differential spectrum ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    FractionBox["dN", "dE"]}], TraditionalForm]],ExpressionUUID->
  "ed0ac03d-a463-458d-bcf6-07192b70da8b"],
 ") should be formatted as an array of values of power per unit area ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["GeV", 
      RowBox[{"-", "1"}]], 
     SuperscriptBox["cm", 
      RowBox[{"-", "2"}]], " "}]}], TraditionalForm]],ExpressionUUID->
  "d452283b-ce26-404b-af79-20af551b0140"],
 " ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["s", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "cd96b54a-be13-4750-8956-7d481726c0a6"],
 ") evaluated at the energies given by the array, \[OpenCurlyDoubleQuote]",
 StyleBox["energies", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote]. Below, the variable, \[OpenCurlyDoubleQuote]",
 StyleBox["pointSourceSpectrum", "Input",
  FontSize->16],
 StyleBox["\[CloseCurlyDoubleQuote]", "Input"],
 " is assigned the output list of the function \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadePoint", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote]. \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadePoint", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] is passed a differential spectrum ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    FractionBox["dN", 
     SubscriptBox["dE", "\[Gamma]"]], ")"}], TraditionalForm]],
  ExpressionUUID->"f50e1099-51ae-4d16-ba39-ab04fe084c24"],
 " which is ",
 StyleBox["injSpectrum.", "Input",
  FontSize->16],
 StyleBox[" ", "Input",
  FontFamily->"Gill Sans MT",
  FontSize->18,
  FontWeight->"Bold"],
 StyleBox["The injected energy spectrum is then propagated from Z = 0.001", 
  "Input",
  FontFamily->"Gill Sans MT",
  FontSize->18,
  FontWeight->"Plain"],
 StyleBox[".",
  FontSize->18],
 StyleBox[" The attenuated spectrum is then shown on top to highlight the \
effect of cosmological cascades.",
  FontFamily->"Sans Serif",
  FontSize->18]
}], "Subsection",
 CellChangeTimes->{{3.725052707973753*^9, 3.7250527375589714`*^9}, {
   3.7250528464457674`*^9, 3.725052847117523*^9}, {3.725052895068542*^9, 
   3.725052977265681*^9}, {3.7250553273517904`*^9, 3.725055340556327*^9}, {
   3.7250553745754757`*^9, 3.725055375341176*^9}, {3.7250554826493034`*^9, 
   3.725055541357113*^9}, {3.725056079100033*^9, 3.7250561057903404`*^9}, {
   3.7250561367940245`*^9, 3.725056139012768*^9}, {3.72505621314529*^9, 
   3.7250562843402357`*^9}, {3.72505631884388*^9, 3.7250563191251154`*^9}, {
   3.725056380678432*^9, 3.7250564148543425`*^9}, {3.7250567825797205`*^9, 
   3.725056812760852*^9}, {3.725056844120059*^9, 3.725056940387824*^9}, {
   3.725057306956557*^9, 3.725057315034707*^9}, {3.7252864103612857`*^9, 
   3.7252864192370157`*^9}, {3.725302108898698*^9, 3.725302124750896*^9}, {
   3.725302161468994*^9, 3.72530216733508*^9}, {3.725302985826969*^9, 
   3.7253030041572113`*^9}, {3.7253045190476665`*^9, 
   3.7253045192100887`*^9}, {3.7314132159778614`*^9, 
   3.7314132271605945`*^9}, {3.7314132977803693`*^9, 3.7314133043337946`*^9}, 
   3.7314477514600515`*^9, {3.7314492815309696`*^9, 3.7314492880432854`*^9}, 
   3.7365574299200883`*^9, {3.737467188052978*^9, 3.7374671934624305`*^9}, {
   3.7374672698489623`*^9, 3.7374672906252947`*^9}, {3.751165919273855*^9, 
   3.751166009286096*^9}, 3.751166039312459*^9, {3.751166084569523*^9, 
   3.751166111364891*^9}, {3.75116614292492*^9, 3.75116622840024*^9}},
 CellID->79685355,ExpressionUUID->"b514389b-3819-4c09-957c-80e55adefe77"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pointSourceSpectrum", "=", 
    RowBox[{"GCascadePoint", "[", 
     RowBox[{"injSpectrum", ",", "0.001"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"pointSourceSpectrumPlot", "=", 
  RowBox[{
  "specPlot", "[", "pointSourceSpectrum", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"pointSourceSpectrumPlot", ",", "attenuatedSpectrumPlot"}], 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.7250565838719664`*^9, 3.725056947826231*^9, {3.725126709952607*^9, 
   3.7251267131565313`*^9}, {3.7252994237443085`*^9, 
   3.7252994283358183`*^9}, {3.7253008379527683`*^9, 
   3.7253008386491737`*^9}, {3.72530104693525*^9, 3.7253010589605427`*^9}, {
   3.7253011692042274`*^9, 3.725301175547295*^9}, 3.7253035250019474`*^9, 
   3.725303732961641*^9, 3.7253733395697155`*^9, 3.7257511203618927`*^9, 
   3.725764156799802*^9, {3.7258084866043067`*^9, 3.7258084866905484`*^9}, {
   3.72580903943323*^9, 3.7258091162525396`*^9}, {3.7258091634150305`*^9, 
   3.7258091643946333`*^9}, {3.725809458865136*^9, 3.725809464875127*^9}, {
   3.725809504548687*^9, 3.725809504992869*^9}, {3.7258095635316243`*^9, 
   3.7258095644229965`*^9}, 3.7269473464042993`*^9, 3.7269485167674136`*^9, {
   3.727486636764838*^9, 3.7274866371901445`*^9}, {3.7274866852649145`*^9, 
   3.727486685900262*^9}, {3.7274869819537745`*^9, 3.7274869823139772`*^9}, {
   3.727487083910822*^9, 3.7274870950529375`*^9}, {3.7274872585626893`*^9, 
   3.7274872651095657`*^9}, {3.7274874152896953`*^9, 
   3.7274874700623407`*^9}, {3.727488001882295*^9, 3.7274880194194174`*^9}, {
   3.7274888471300764`*^9, 3.7274889381041183`*^9}, {3.7275372536709585`*^9, 
   3.7275372824635105`*^9}, {3.7275374338656178`*^9, 3.727537434952155*^9}, {
   3.729913091322496*^9, 3.729913099074986*^9}, {3.7311575755717883`*^9, 
   3.7311575757622952`*^9}, {3.7313455320783567`*^9, 3.7313455390920124`*^9}, 
   3.7313455933582954`*^9, {3.7314131239390254`*^9, 3.7314131292582035`*^9}, {
   3.7314131982626486`*^9, 3.7314132016356153`*^9}, 3.7314133137879324`*^9, {
   3.7314485430343533`*^9, 3.7314485437783318`*^9}, 3.7358441958874054`*^9, 
   3.736553385428315*^9, 3.751163318354281*^9, {3.75116350351095*^9, 
   3.751163519405622*^9}, 3.751165910937016*^9},
 CellLabel->"In[40]:=",
 CellID->361323213,ExpressionUUID->"7482f063-9516-428f-921a-e987e5a61aa3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Diffuse Gamma-Ray Background from a Non-evolving  Population of Sources\
\>", "Section",
 CellChangeTimes->{{3.7250570571679015`*^9, 3.725057085071234*^9}, {
  3.7253045837930994`*^9, 3.725304602055767*^9}, {3.75122249701081*^9, 
  3.751222501861668*^9}},
 CellID->20797861,ExpressionUUID->"e2ee105f-5f8e-4c81-9f05-598ef6ca1163"],

Cell[CellGroupData[{

Cell[TextData[{
 "We can consider the diffuse gamma-ray background from a class of sources, \
which have some  non-evolving intrinsic spectral properties and are \
distributed continuously as a function of redshift, z. To calculate the \
diffuse gamma-ray spectrum expected from such a class of sources, you can use \
the \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuseConstant", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote]  function.  \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuseConstant[injected spectrum ,max Z ", "Input",
  FontSize->16],
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["z", "max"]}], TraditionalForm]],
  FontSize->16,ExpressionUUID->"34b9ccdb-5284-4cdb-9bff-9d9f03d460b2"],
 StyleBox["),Luminosity Function (\[Rho](z))]", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] is a function which takes in a gamma-ray injected \
luminosity spectrum, max z,  and a luminosity function.\n\
\[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuseConstant", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] produces a cascaded diffuse differential spectrum, \
",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["dN", "dE"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["GeV", 
        RowBox[{"-", "1"}]], 
       SuperscriptBox["cm", 
        RowBox[{"-", "2"}]], " ", 
       SuperscriptBox["s", 
        RowBox[{"-", "1"}]], " ", 
       SuperscriptBox["sr", 
        RowBox[{"-", "1"}]]}], ")"}]}], ")"}], TraditionalForm]],
  ExpressionUUID->"1fcb2e0b-8f51-4b44-8b3c-554f17d147b4"],
 " , taking into account cosmological and electromagnetic cascade evolution. \
\nThe Luminosity distribution function is assumed to be a separable function \
of the form: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["dN", 
      RowBox[{
       SubscriptBox["dV", "c"], "dE"}]], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["E", "\[Gamma]"], ",", "z"}], ")"}]}], "=", 
    RowBox[{
     FractionBox["dN", 
      SubscriptBox["dE", "\[Gamma]"]], 
     RowBox[{"(", 
      SubscriptBox["E", "\[Gamma]"], ")"}], 
     RowBox[{"\[Rho]", "(", "z", ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "76babc4c-4039-471c-b207-cbb592c38e09"],
 " where the left-hand factor is the intrinsic differential spectrum of the \
class of sources ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["dN", 
      SubscriptBox["dE", "\[Gamma]"]], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["GeV", 
        RowBox[{"-", "1"}]], " ", 
       SuperscriptBox["s", 
        RowBox[{"-", "1"}]]}], ")"}]}], ")"}], TraditionalForm]],
  ExpressionUUID->"04ff199a-c06b-4cdc-9202-e791ee062195"],
 " and \[Rho](z) is the spacial distribution of the sources in units of \
density per comoving volume, so called \[OpenCurlyDoubleQuote]luminosity \
function\[CloseCurlyDoubleQuote]. \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuseConstant", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] uses the luminosity function as an input which \
must be formatted as list of ordered pairs (z,",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "(", "z", ")"}], TraditionalForm]],ExpressionUUID->
  "6f270eb1-4ea5-49d7-84e3-741eabff56a1"],
 "), of values of z and density \[Rho](z). The values of z can be any finite \
list of z from 0 to 10. ",
 StyleBox["GCascade",
  FontWeight->"Bold"],
 " provides two convenient lists of z, \[OpenCurlyDoubleQuote]",
 StyleBox["zReg", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] and \[OpenCurlyDoubleQuote]",
 StyleBox["diffuseDistances", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote].  \[OpenCurlyDoubleQuote]",
 StyleBox["zReg", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] is a list that contains values of z from 0 to 10 \
in increments of 0.01. \[OpenCurlyDoubleQuote]",
 StyleBox["diffuseDistances", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] is a list that contains values of z from 0 to 10 \
in progressively increasing step sizes as z gets closer to 0. \
\[OpenCurlyDoubleQuote]",
 StyleBox["diffuseDistances", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] is the list of z-values used by the code to carry \
out the numerical integration (i.e. location of integration steps). This is a \
good list to use when ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "(", "z", ")"}], TraditionalForm]],ExpressionUUID->
  "73b64b31-c514-4c53-bdcf-592d71205e2a"],
 " is mainly localized near ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "4db90c07-d0d5-4bab-ba18-6df7d70e310e"],
 ".  \n\nBelow, the variable \[OpenCurlyDoubleQuote]",
 StyleBox["diffuseConstantBackgroundSpectrum", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] is assigned the output list of the function \
\[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuseConstant", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote]. \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuseConstant", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] is passed a differential luminosity spectrum ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    FractionBox["dN", 
     SubscriptBox["dE", "\[Gamma]"]], ")"}], TraditionalForm]],
  ExpressionUUID->"03e6b49f-6f6d-4d4c-a83f-b7bacb636737"],
 " which is \[OpenCurlyDoubleQuote]",
 StyleBox["injSpectrum\[CloseCurlyDoubleQuote]", "Input",
  FontSize->16],
 StyleBox[". The Injected energy spectrum is then allowed to propagate from z \
= 0.1", "Input",
  FontFamily->"Gill Sans MT",
  FontSize->18,
  FontWeight->"Plain"],
 StyleBox[". The last input in the list is, \[OpenCurlyDoubleQuote]\[Rho](z)\
\[CloseCurlyDoubleQuote], and is created by first generating a list equal in  \
size to \[OpenCurlyDoubleQuote]",
  FontSize->18],
 StyleBox["diffuseDistance", "Input",
  FontSize->16],
 StyleBox["\[CloseCurlyDoubleQuote]. The first 46 elements are set to the \
density, ",
  FontSize->18],
 "The list of z-values and ",
 Cell[BoxData[
  FormBox["\[Rho]", TraditionalForm]],ExpressionUUID->
  "fc51e754-7334-4653-8150-47a77c4a9816"],
 "-values are then merged into ordered pair using the \
\[OpenCurlyDoubleQuote]T",
 StyleBox["hread", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] function and assigned the variable \
\[OpenCurlyDoubleQuote]",
 StyleBox["\[Rho]", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote]. This example evaluates the observed spectrum from \
a distribution of sources with a constant comoving number density of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"5", 
     SuperscriptBox["x10", 
      RowBox[{"-", "6"}]], " ", 
     SuperscriptBox["Mpc", 
      RowBox[{"-", "3"}]]}]}], TraditionalForm]],ExpressionUUID->
  "3395a601-992b-40d9-9532-d85a57189efb"],
 ") out to a maximum z of 0.1.  Note that the comoving number density must be \
converted to units of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SuperscriptBox["cm", 
     RowBox[{"-", "3"}]]}], TraditionalForm]],ExpressionUUID->
  "86862e4f-bd59-4ba6-a266-0debfe4ca104"],
 "). This should take one or two minutes."
}], "Subsection",
 CellChangeTimes->{{3.7250571186807013`*^9, 3.725057292375537*^9}, {
   3.7250573252276497`*^9, 3.7250573411442385`*^9}, 3.7250593741062*^9, {
   3.725122223641325*^9, 3.7251223610563045`*^9}, {3.7251223911045084`*^9, 
   3.7251228880855083`*^9}, {3.725122946278465*^9, 3.7251232806431646`*^9}, {
   3.725123313620189*^9, 3.7251233197143793`*^9}, {3.725123445730384*^9, 
   3.725123447045088*^9}, {3.7251234863076363`*^9, 3.7251238217307067`*^9}, {
   3.725123863970313*^9, 3.725123988346312*^9}, {3.7252864300818615`*^9, 
   3.7252864405829587`*^9}, {3.7253023020691557`*^9, 3.725302347074763*^9}, 
   3.7253023998798127`*^9, {3.725303092537721*^9, 3.7253030937065372`*^9}, {
   3.7253046322090282`*^9, 3.725304663413898*^9}, {3.7258038463758593`*^9, 
   3.7258038486468744`*^9}, {3.72580389147686*^9, 3.725804323523389*^9}, {
   3.725804377902076*^9, 3.725804627711749*^9}, {3.7258047434105916`*^9, 
   3.7258047777439775`*^9}, {3.725804858734436*^9, 3.725804858900879*^9}, {
   3.7258051538466744`*^9, 3.7258052331356134`*^9}, {3.7258052808505697`*^9, 
   3.725805362394535*^9}, {3.725805407092487*^9, 3.725805683106861*^9}, {
   3.725805715216296*^9, 3.725805941733996*^9}, {3.7258060303628125`*^9, 
   3.7258060303628125`*^9}, {3.7258060832886333`*^9, 
   3.7258061247700033`*^9}, {3.725806172704544*^9, 3.725806174485282*^9}, {
   3.725806248684733*^9, 3.7258062868382215`*^9}, {3.7258064173715353`*^9, 
   3.7258064356020675`*^9}, {3.726878282037089*^9, 3.7268783039982862`*^9}, {
   3.731413253482585*^9, 3.731413275929268*^9}, {3.7314133725662208`*^9, 
   3.7314134278191338`*^9}, {3.7314477516074495`*^9, 
   3.7314477517427797`*^9}, {3.731449572809461*^9, 3.731449575673075*^9}, {
   3.7314497792954946`*^9, 3.7314497795762415`*^9}, {3.731449829719569*^9, 
   3.731449848397232*^9}, {3.731449948490402*^9, 3.731450152928963*^9}, {
   3.731450207337632*^9, 3.7314503849739556`*^9}, {3.7314513618686037`*^9, 
   3.731451460608522*^9}, {3.73145174400305*^9, 3.731451771622488*^9}, {
   3.731451830135069*^9, 3.7314518357951193`*^9}, 3.737466845038596*^9, {
   3.737467757976621*^9, 3.737467762613515*^9}, {3.75116646386931*^9, 
   3.751166571874826*^9}, {3.7511666152321053`*^9, 3.7511666260613317`*^9}, 
   3.751166660508484*^9, {3.751166722613907*^9, 3.751166722805595*^9}, {
   3.751166775889784*^9, 3.751166801064102*^9}, {3.751166847767342*^9, 
   3.751167036933495*^9}, {3.7511672712249603`*^9, 3.751167309937714*^9}, {
   3.751170219180656*^9, 3.751170220514648*^9}},
 CellID->234064909,ExpressionUUID->"ef4078cd-9d91-4348-bbd5-a66f833326c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Mpc", " ", "=", " ", 
    RowBox[{"3.086", "*", 
     RowBox[{"10", "^", "24"}]}]}], ";"}], " ", 
  RowBox[{"(*", "cm", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]z", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0.0", ",", 
      RowBox[{"Length", "[", "diffuseDistances", "]"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"creates", " ", "array"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]z", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "46"}], "]"}], "]"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"5.0", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]], "*", 
       SuperscriptBox[
        RowBox[{"(", "Mpc", ")"}], 
        RowBox[{"-", "3"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "46"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"sets", " ", "the", " ", "first", " ", "46", " ", "members"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{"diffuseDistances", ",", "\[Rho]z"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diffuseConstantBackgroundSpectrum", "=", 
    RowBox[{"GCascadeDiffuseConstant", "[", 
     RowBox[{"injSpectrum", ",", 
      RowBox[{"diffuseDistances", "[", 
       RowBox[{"[", "46", "]"}], "]"}], ",", "\[Rho]"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"diffuseConstantBackgroundSpectrumPlot", "=", 
  RowBox[{
  "specPlot", "[", "diffuseConstantBackgroundSpectrum", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.724382309803336*^9, 3.7243823432002273`*^9}, {
   3.724437491299893*^9, 3.724437493778811*^9}, {3.725123379478029*^9, 
   3.725123428536578*^9}, {3.7251238011319065`*^9, 3.7251238023828015`*^9}, {
   3.725123834074115*^9, 3.725123856271241*^9}, 3.7251242966960816`*^9, {
   3.7251243292307267`*^9, 3.7251243606704254`*^9}, {3.725124955807994*^9, 
   3.725124999313011*^9}, {3.7251251881633015`*^9, 3.725125223292445*^9}, 
   3.725285948063451*^9, {3.7253022510666285`*^9, 3.725302273597242*^9}, {
   3.7253035707278275`*^9, 3.7253037242578554`*^9}, {3.725762706754038*^9, 
   3.7257627179937553`*^9}, {3.7257637772658243`*^9, 
   3.7257637895467844`*^9}, {3.7257638273705187`*^9, 3.725763865528574*^9}, {
   3.7257639051963162`*^9, 3.725763981803931*^9}, {3.7257673988791904`*^9, 
   3.7257674026796255`*^9}, {3.7257679519704404`*^9, 3.725767953948434*^9}, 
   3.7258035386630974`*^9, {3.725803653043429*^9, 3.7258036585821657`*^9}, 
   3.725803736737114*^9, {3.72580439640631*^9, 3.7258044011338882`*^9}, {
   3.7258063982656994`*^9, 3.7258063985735188`*^9}, 3.7268567815638075`*^9, {
   3.7268568870278454`*^9, 3.726856892868373*^9}, {3.7268569426020803`*^9, 
   3.726856944888582*^9}, {3.7268570837492943`*^9, 3.726857104502345*^9}, {
   3.72685760455017*^9, 3.726857605331069*^9}, {3.7268753501206894`*^9, 
   3.726875363606491*^9}, {3.726875812212006*^9, 3.7268758127589245`*^9}, {
   3.7268761075715857`*^9, 3.7268761327148933`*^9}, {3.7268762486022544`*^9, 
   3.726876282699646*^9}, {3.7268763161568003`*^9, 3.7268763278763337`*^9}, {
   3.726876392789338*^9, 3.7268764040566273`*^9}, {3.726876857865013*^9, 
   3.726876880821059*^9}, {3.726876981643834*^9, 3.726877034719083*^9}, {
   3.7268770953935156`*^9, 3.726877128679932*^9}, {3.7268772015067987`*^9, 
   3.7268772081878133`*^9}, {3.726877315427498*^9, 3.7268773221782193`*^9}, {
   3.726877388339192*^9, 3.7268773886830125`*^9}, {3.7268785832058043`*^9, 
   3.7268786033605022`*^9}, {3.7268786348910627`*^9, 
   3.7268786753473935`*^9}, {3.726878871567321*^9, 3.7268788720361166`*^9}, {
   3.726879028806199*^9, 3.726879029066758*^9}, 3.7268791427822847`*^9, 
   3.726879327747587*^9, {3.726879985040123*^9, 3.726880001835026*^9}, 
   3.726880033462098*^9, {3.726880152413319*^9, 3.726880157397769*^9}, {
   3.7268802917739143`*^9, 3.7268802946664066`*^9}, {3.726880488245967*^9, 
   3.7268804884490814`*^9}, {3.7268806084658375`*^9, 3.726880614719679*^9}, {
   3.7268810099695625`*^9, 3.7268810100320687`*^9}, {3.726881232856736*^9, 
   3.7268812625286713`*^9}, {3.726881496087859*^9, 3.726881496884845*^9}, {
   3.7268818353249135`*^9, 3.726881851435959*^9}, {3.726882913127477*^9, 
   3.726882913221266*^9}, {3.7269220510664887`*^9, 3.7269220513165045`*^9}, {
   3.726945618771902*^9, 3.726945620412772*^9}, {3.726946475453478*^9, 
   3.72694650148615*^9}, {3.7269467923846807`*^9, 3.726946816292409*^9}, {
   3.7269474562628655`*^9, 3.726947478979896*^9}, {3.7269488300091877`*^9, 
   3.726948836432607*^9}, {3.7270149149294405`*^9, 3.727015023892454*^9}, {
   3.727021246331297*^9, 3.727021285277032*^9}, {3.727022002849168*^9, 
   3.7270220087222953`*^9}, {3.7270220487585316`*^9, 3.727022065212284*^9}, {
   3.727486222849906*^9, 3.727486223225199*^9}, {3.727490597387869*^9, 
   3.7274905998942003`*^9}, 3.727491012648535*^9, 3.727491178081356*^9, {
   3.7274912859086466`*^9, 3.72749128669916*^9}, {3.727491411340328*^9, 
   3.727491411775547*^9}, {3.7299135939442854`*^9, 3.7299136249085665`*^9}, {
   3.73021862109149*^9, 3.730218632204378*^9}, 3.7302186852870646`*^9, 
   3.7313459802079043`*^9, {3.7313460159639783`*^9, 3.731346044497874*^9}, 
   3.731447735816459*^9, {3.7314498096572247`*^9, 3.7314498118159647`*^9}, {
   3.73145048084086*^9, 3.731450547311601*^9}, {3.7314507637084947`*^9, 
   3.7314507758437614`*^9}, {3.7314510380445757`*^9, 3.731451086524482*^9}, 
   3.7314513483245907`*^9, {3.731451477845353*^9, 3.7314515578260174`*^9}, {
   3.731451612433243*^9, 3.7314516124452457`*^9}, {3.731451695046878*^9, 
   3.7314517248802276`*^9}, {3.7314518438896427`*^9, 
   3.7314518443338237`*^9}, {3.7356738014094133`*^9, 3.735673808864825*^9}, {
   3.735673854658144*^9, 3.7356738609144173`*^9}, {3.7358288579142303`*^9, 
   3.735828874613027*^9}, {3.735828981385913*^9, 3.735828981565816*^9}, {
   3.7358662504483395`*^9, 3.7358662571884365`*^9}, {3.735867941385335*^9, 
   3.7358679479857197`*^9}, {3.7365527496888247`*^9, 
   3.7365527544281454`*^9}, {3.7373102628941836`*^9, 
   3.7373102684932146`*^9}, {3.737400552881925*^9, 3.737400577099455*^9}, {
   3.737407106153408*^9, 3.7374071119293385`*^9}, {3.737466809252296*^9, 
   3.7374668141621146`*^9}, {3.751166857906969*^9, 3.7511668649017487`*^9}, {
   3.751167060358019*^9, 3.751167092883814*^9}, 3.751167140113583*^9, {
   3.751167198265745*^9, 3.75116719914883*^9}},
 CellLabel->"In[29]:=",
 CellID->523388465,ExpressionUUID->"2931d7d1-b94f-4f65-ad2f-7fde3752327c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Diffuse Gamma-Ray Background from an Evolving Population of Sources\
\>", "Section",
 CellChangeTimes->{{3.7250570571679015`*^9, 3.725057085071234*^9}, {
  3.7253045837930994`*^9, 3.725304602055767*^9}, {3.751170205567389*^9, 
  3.751170209610299*^9}},
 CellID->926635129,ExpressionUUID->"3d3cb475-3bb4-40e6-b5b7-37172e34fa49"],

Cell[CellGroupData[{

Cell[TextData[{
 "Finally, we consider the diffuse gamma-ray background from a class of \
sources, which have some  evolving intrinsic spectral properties and are \
distributed continuously as a function of redshift, z. To calculate the \
diffuse gamma-ray spectrum expected from such a class of sources, you can use \
the \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuse", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote]  function.  \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuse[injected spectrum ,max Z ", "Input",
  FontSize->16],
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["z", "max"]}], TraditionalForm]],
  FontSize->16,ExpressionUUID->"773e3373-1154-40aa-97dd-796b3b278be8"],
 StyleBox["),Luminosity Function (\[Rho](z))]", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] is a function which takes in a gamma-ray injected \
luminosity spectrum, max z,  and a luminosity function.\n\
\[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuse", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] produces a cascaded diffuse differential spectrum, \
",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["dN", "dE"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["GeV", 
        RowBox[{"-", "1"}]], 
       SuperscriptBox["cm", 
        RowBox[{"-", "2"}]], " ", 
       SuperscriptBox["s", 
        RowBox[{"-", "1"}]], " ", 
       SuperscriptBox["sr", 
        RowBox[{"-", "1"}]]}], ")"}]}], ")"}], TraditionalForm]],
  ExpressionUUID->"9c190751-0052-413e-8b89-691e278e9b81"],
 " , taking into account cosmological and electromagnetic cascade evolution. \
\nThe Luminosity distribution function is assumed to be a separable function \
of the form: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["dN", 
      RowBox[{
       SubscriptBox["dV", "c"], "dE"}]], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["E", "\[Gamma]"], ",", "z"}], ")"}]}], "=", 
    RowBox[{
     FractionBox["dN", 
      SubscriptBox["dE", "\[Gamma]"]], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["E", "\[Gamma]"], ",", "z"}], ")"}], 
     RowBox[{"\[Rho]", "(", "z", ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "9db37431-8fc3-4ac9-915c-a5cbd85e9bc8"],
 " where the left-hand factor is the intrinsic differential spectrum of the \
class of sources ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["dN", 
      SubscriptBox["dE", "\[Gamma]"]], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["GeV", 
        RowBox[{"-", "1"}]], " ", 
       SuperscriptBox["s", 
        RowBox[{"-", "1"}]]}], ")"}]}], ")"}], TraditionalForm]],
  ExpressionUUID->"340018cc-cf73-4d16-8ace-df6d7c5a9413"],
 " as a function of z and \[Rho](z) is the spacial distribution of the \
sources in units of density per comoving volume, so called \
\[OpenCurlyDoubleQuote]luminosity function\[CloseCurlyDoubleQuote]. \
\[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuse", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] uses the luminosity function as an input which \
must be formatted as list of ordered pairs (z,",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "(", "z", ")"}], TraditionalForm]],ExpressionUUID->
  "4ac728d4-f5f0-4bc7-bf40-61f1835a9d3f"],
 "), of values of z and density \[Rho](z). The values of z must be those \
given in the list, \[OpenCurlyDoubleQuote]",
 StyleBox["diffuseDistances", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote]. \[OpenCurlyDoubleQuote]",
 StyleBox["diffuseDistances", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] is a list that contains values of z from 0 to 10 \
in progressively increasing step sizes as z gets closer to 0. \
\[OpenCurlyDoubleQuote]",
 StyleBox["diffuseDistances", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] is the list of z-values used by the code to carry \
out the numerical integration (i.e. location of integration steps). \
Additionally, \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuse", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] uses the evolving differential spectrum, ",
 StyleBox["injected spectrum =", "Input",
  FontSize->16],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["dN", 
     RowBox[{
      SubscriptBox["dV", "c"], "dE"}]], 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["E", "\[Gamma]"], ",", "z"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"39a5cdb4-75fa-4ec6-97aa-5bd388d242b2"],
 ", as an input. ",
 StyleBox["injected spectrum", "Input",
  FontSize->16],
 " must be a list of spectra, each formatted as in the examples above. Each \
member of, ",
 StyleBox["injected spectrum", "Input",
  FontSize->16],
 ", must be the spectrum injected at the z-values given by, \
\[OpenCurlyDoubleQuote]",
 StyleBox["diffuseDistances", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote]. \n\n\nBelow, the variable \[OpenCurlyDoubleQuote]",
 StyleBox["diffuseBackgroundSpectrum", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] is assigned the output list of the function \
\[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuse", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote]. \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuse", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] is passed a differential luminosity spectrum ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["dN", 
      SubscriptBox["dE", "\[Gamma]"]], 
     RowBox[{"(", "z", ")"}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "cd40e5c2-408f-4ab9-8939-97366cc71ffe"],
 " which is \[OpenCurlyDoubleQuote]",
 StyleBox["injSpectrum2\[CloseCurlyDoubleQuote]", "Input",
  FontSize->16],
 StyleBox[". In this example, the injected spectrum is a power law similar to \
the one in the first example but whose spectral index changes as ", "Input",
  FontFamily->"Gill Sans MT",
  FontSize->18,
  FontWeight->"Plain"],
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalGamma]", "=", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", "z"}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "2be15e4c-c589-4044-8620-949e3cda41ea"],
 ". ",
 StyleBox["The Injected energy spectra are then propagated from a max z = \
0.1", "Input",
  FontFamily->"Gill Sans MT",
  FontSize->18,
  FontWeight->"Plain"],
 StyleBox[". The last input in the list is, \[OpenCurlyDoubleQuote]\[Rho](z)\
\[CloseCurlyDoubleQuote], and is created by first generating a list equal in  \
size to \[OpenCurlyDoubleQuote]",
  FontSize->18],
 StyleBox["diffuseDistance", "Input",
  FontSize->16],
 StyleBox["\[CloseCurlyDoubleQuote]. The first 46 elements are set to the \
density, ",
  FontSize->18],
 "The list of z-values and ",
 Cell[BoxData[
  FormBox["\[Rho]", TraditionalForm]],ExpressionUUID->
  "5b8f4e55-b028-434b-8518-c52e1c064fb8"],
 "-values are then merged into ordered pair using the \
\[OpenCurlyDoubleQuote]T",
 StyleBox["hread", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] function and assigned the variable \
\[OpenCurlyDoubleQuote]",
 StyleBox["\[Rho]", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote]. This example evaluates the observed spectrum from \
a distribution of sources with a constant comoving number density of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"5", 
     SuperscriptBox["x10", 
      RowBox[{"-", "6"}]], " ", 
     SuperscriptBox["Mpc", 
      RowBox[{"-", "3"}]]}]}], TraditionalForm]],ExpressionUUID->
  "7dcc2a1f-e8cc-4060-a3ec-27b927b34e60"],
 ") out to a maximum z of 0.1.  Note that the comoving number density must be \
converted to units of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SuperscriptBox["cm", 
     RowBox[{"-", "3"}]]}], TraditionalForm]],ExpressionUUID->
  "e1d5839b-63e8-42b0-8643-d87f6e3ed4fb"],
 "). This should take as long as \[OpenCurlyDoubleQuote]",
 StyleBox["GCascadeDiffuseConstant", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote]."
}], "Subsection",
 CellChangeTimes->{{3.7250571186807013`*^9, 3.725057292375537*^9}, {
   3.7250573252276497`*^9, 3.7250573411442385`*^9}, 3.7250593741062*^9, {
   3.725122223641325*^9, 3.7251223610563045`*^9}, {3.7251223911045084`*^9, 
   3.7251228880855083`*^9}, {3.725122946278465*^9, 3.7251232806431646`*^9}, {
   3.725123313620189*^9, 3.7251233197143793`*^9}, {3.725123445730384*^9, 
   3.725123447045088*^9}, {3.7251234863076363`*^9, 3.7251238217307067`*^9}, {
   3.725123863970313*^9, 3.725123988346312*^9}, {3.7252864300818615`*^9, 
   3.7252864405829587`*^9}, {3.7253023020691557`*^9, 3.725302347074763*^9}, 
   3.7253023998798127`*^9, {3.725303092537721*^9, 3.7253030937065372`*^9}, {
   3.7253046322090282`*^9, 3.725304663413898*^9}, {3.7258038463758593`*^9, 
   3.7258038486468744`*^9}, {3.72580389147686*^9, 3.725804323523389*^9}, {
   3.725804377902076*^9, 3.725804627711749*^9}, {3.7258047434105916`*^9, 
   3.7258047777439775`*^9}, {3.725804858734436*^9, 3.725804858900879*^9}, {
   3.7258051538466744`*^9, 3.7258052331356134`*^9}, {3.7258052808505697`*^9, 
   3.725805362394535*^9}, {3.725805407092487*^9, 3.725805683106861*^9}, {
   3.725805715216296*^9, 3.725805941733996*^9}, {3.7258060303628125`*^9, 
   3.7258060303628125`*^9}, {3.7258060832886333`*^9, 
   3.7258061247700033`*^9}, {3.725806172704544*^9, 3.725806174485282*^9}, {
   3.725806248684733*^9, 3.7258062868382215`*^9}, {3.7258064173715353`*^9, 
   3.7258064356020675`*^9}, {3.726878282037089*^9, 3.7268783039982862`*^9}, {
   3.731413253482585*^9, 3.731413275929268*^9}, {3.7314133725662208`*^9, 
   3.7314134278191338`*^9}, {3.7314477516074495`*^9, 
   3.7314477517427797`*^9}, {3.731449572809461*^9, 3.731449575673075*^9}, {
   3.7314497792954946`*^9, 3.7314497795762415`*^9}, {3.731449829719569*^9, 
   3.731449848397232*^9}, {3.731449948490402*^9, 3.731450152928963*^9}, {
   3.731450207337632*^9, 3.7314503849739556`*^9}, {3.7314513618686037`*^9, 
   3.731451460608522*^9}, {3.73145174400305*^9, 3.731451771622488*^9}, {
   3.731451830135069*^9, 3.7314518357951193`*^9}, 3.737466845038596*^9, {
   3.737467757976621*^9, 3.737467762613515*^9}, {3.75116646386931*^9, 
   3.751166571874826*^9}, {3.7511666152321053`*^9, 3.7511666260613317`*^9}, 
   3.751166660508484*^9, {3.751166722613907*^9, 3.751166722805595*^9}, {
   3.751166775889784*^9, 3.751166801064102*^9}, {3.751166847767342*^9, 
   3.751167036933495*^9}, {3.7511672712249603`*^9, 3.751167309937714*^9}, {
   3.751170521511282*^9, 3.751170551383546*^9}, {3.751170710746817*^9, 
   3.751170739122162*^9}, {3.7511707816371727`*^9, 3.751170993398347*^9}, {
   3.751171024070956*^9, 3.7511711213848753`*^9}, 3.7511711797606783`*^9, {
   3.7511715207001047`*^9, 3.751171676825561*^9}, {3.751172094816598*^9, 
   3.751172102445223*^9}, {3.7511722036473513`*^9, 3.751172223985574*^9}},
 CellID->1195575519,ExpressionUUID->"a17cc100-a9e1-4899-bd42-6762f4beb86a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"injSpectrum2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"cutoffPowerLaw", "[", 
        RowBox[{
         RowBox[{"energies", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"2.0", "*", 
          RowBox[{"(", 
           RowBox[{"1.", "+", 
            RowBox[{"diffuseDistances", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}], ",", 
         SuperscriptBox["10", "13"], ",", 
         RowBox[{"(", 
          RowBox[{"3.12", "*", 
           SuperscriptBox["10", "42"]}], ")"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "diffuseDistances", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mpc", " ", "=", " ", 
   RowBox[{"3.086", "*", 
    RowBox[{"10", "^", "24"}]}]}], ";", " ", 
  RowBox[{"(*", "cm", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Rho]z", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"Length", "[", "diffuseDistances", "]"}]}], "]"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"creates", " ", "array"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Rho]z", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "46"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"5.0", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]], "*", 
      SuperscriptBox[
       RowBox[{"(", "Mpc", ")"}], 
       RowBox[{"-", "3"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "46"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"sets", " ", "the", " ", "first", " ", "46", " ", "members"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Rho]", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{"diffuseDistances", ",", "\[Rho]z"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diffuseBackgroundSpectrum", "=", 
    RowBox[{"GCascadeDiffuse", "[", 
     RowBox[{"injSpectrum2", ",", 
      RowBox[{"diffuseDistances", "[", 
       RowBox[{"[", "46", "]"}], "]"}], ",", "\[Rho]"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"diffuseBackgroundSpectrumPlot", "=", 
  RowBox[{
  "specPlot", "[", "diffuseBackgroundSpectrum", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.724382309803336*^9, 3.7243823432002273`*^9}, {
   3.724437491299893*^9, 3.724437493778811*^9}, {3.725123379478029*^9, 
   3.725123428536578*^9}, {3.7251238011319065`*^9, 3.7251238023828015`*^9}, {
   3.725123834074115*^9, 3.725123856271241*^9}, 3.7251242966960816`*^9, {
   3.7251243292307267`*^9, 3.7251243606704254`*^9}, {3.725124955807994*^9, 
   3.725124999313011*^9}, {3.7251251881633015`*^9, 3.725125223292445*^9}, 
   3.725285948063451*^9, {3.7253022510666285`*^9, 3.725302273597242*^9}, {
   3.7253035707278275`*^9, 3.7253037242578554`*^9}, {3.725762706754038*^9, 
   3.7257627179937553`*^9}, {3.7257637772658243`*^9, 
   3.7257637895467844`*^9}, {3.7257638273705187`*^9, 3.725763865528574*^9}, {
   3.7257639051963162`*^9, 3.725763981803931*^9}, {3.7257673988791904`*^9, 
   3.7257674026796255`*^9}, {3.7257679519704404`*^9, 3.725767953948434*^9}, 
   3.7258035386630974`*^9, {3.725803653043429*^9, 3.7258036585821657`*^9}, 
   3.725803736737114*^9, {3.72580439640631*^9, 3.7258044011338882`*^9}, {
   3.7258063982656994`*^9, 3.7258063985735188`*^9}, 3.7268567815638075`*^9, {
   3.7268568870278454`*^9, 3.726856892868373*^9}, {3.7268569426020803`*^9, 
   3.726856944888582*^9}, {3.7268570837492943`*^9, 3.726857104502345*^9}, {
   3.72685760455017*^9, 3.726857605331069*^9}, {3.7268753501206894`*^9, 
   3.726875363606491*^9}, {3.726875812212006*^9, 3.7268758127589245`*^9}, {
   3.7268761075715857`*^9, 3.7268761327148933`*^9}, {3.7268762486022544`*^9, 
   3.726876282699646*^9}, {3.7268763161568003`*^9, 3.7268763278763337`*^9}, {
   3.726876392789338*^9, 3.7268764040566273`*^9}, {3.726876857865013*^9, 
   3.726876880821059*^9}, {3.726876981643834*^9, 3.726877034719083*^9}, {
   3.7268770953935156`*^9, 3.726877128679932*^9}, {3.7268772015067987`*^9, 
   3.7268772081878133`*^9}, {3.726877315427498*^9, 3.7268773221782193`*^9}, {
   3.726877388339192*^9, 3.7268773886830125`*^9}, {3.7268785832058043`*^9, 
   3.7268786033605022`*^9}, {3.7268786348910627`*^9, 
   3.7268786753473935`*^9}, {3.726878871567321*^9, 3.7268788720361166`*^9}, {
   3.726879028806199*^9, 3.726879029066758*^9}, 3.7268791427822847`*^9, 
   3.726879327747587*^9, {3.726879985040123*^9, 3.726880001835026*^9}, 
   3.726880033462098*^9, {3.726880152413319*^9, 3.726880157397769*^9}, {
   3.7268802917739143`*^9, 3.7268802946664066`*^9}, {3.726880488245967*^9, 
   3.7268804884490814`*^9}, {3.7268806084658375`*^9, 3.726880614719679*^9}, {
   3.7268810099695625`*^9, 3.7268810100320687`*^9}, {3.726881232856736*^9, 
   3.7268812625286713`*^9}, {3.726881496087859*^9, 3.726881496884845*^9}, {
   3.7268818353249135`*^9, 3.726881851435959*^9}, {3.726882913127477*^9, 
   3.726882913221266*^9}, {3.7269220510664887`*^9, 3.7269220513165045`*^9}, {
   3.726945618771902*^9, 3.726945620412772*^9}, {3.726946475453478*^9, 
   3.72694650148615*^9}, {3.7269467923846807`*^9, 3.726946816292409*^9}, {
   3.7269474562628655`*^9, 3.726947478979896*^9}, {3.7269488300091877`*^9, 
   3.726948836432607*^9}, {3.7270149149294405`*^9, 3.727015023892454*^9}, {
   3.727021246331297*^9, 3.727021285277032*^9}, {3.727022002849168*^9, 
   3.7270220087222953`*^9}, {3.7270220487585316`*^9, 3.727022065212284*^9}, {
   3.727486222849906*^9, 3.727486223225199*^9}, {3.727490597387869*^9, 
   3.7274905998942003`*^9}, 3.727491012648535*^9, 3.727491178081356*^9, {
   3.7274912859086466`*^9, 3.72749128669916*^9}, {3.727491411340328*^9, 
   3.727491411775547*^9}, {3.7299135939442854`*^9, 3.7299136249085665`*^9}, {
   3.73021862109149*^9, 3.730218632204378*^9}, 3.7302186852870646`*^9, 
   3.7313459802079043`*^9, {3.7313460159639783`*^9, 3.731346044497874*^9}, 
   3.731447735816459*^9, {3.7314498096572247`*^9, 3.7314498118159647`*^9}, {
   3.73145048084086*^9, 3.731450547311601*^9}, {3.7314507637084947`*^9, 
   3.7314507758437614`*^9}, {3.7314510380445757`*^9, 3.731451086524482*^9}, 
   3.7314513483245907`*^9, {3.731451477845353*^9, 3.7314515578260174`*^9}, {
   3.731451612433243*^9, 3.7314516124452457`*^9}, {3.731451695046878*^9, 
   3.7314517248802276`*^9}, {3.7314518438896427`*^9, 
   3.7314518443338237`*^9}, {3.7356738014094133`*^9, 3.735673808864825*^9}, {
   3.735673854658144*^9, 3.7356738609144173`*^9}, {3.7358288579142303`*^9, 
   3.735828874613027*^9}, {3.735828981385913*^9, 3.735828981565816*^9}, {
   3.7358662504483395`*^9, 3.7358662571884365`*^9}, {3.735867941385335*^9, 
   3.7358679479857197`*^9}, {3.7365527496888247`*^9, 
   3.7365527544281454`*^9}, {3.7373102628941836`*^9, 
   3.7373102684932146`*^9}, {3.737400552881925*^9, 3.737400577099455*^9}, {
   3.737407106153408*^9, 3.7374071119293385`*^9}, {3.737466809252296*^9, 
   3.7374668141621146`*^9}, {3.751166857906969*^9, 3.7511668649017487`*^9}, {
   3.751167060358019*^9, 3.751167092883814*^9}, 3.751167140113583*^9, {
   3.751167198265745*^9, 3.75116719914883*^9}, {3.751171147028425*^9, 
   3.751171172700594*^9}, {3.751171207202002*^9, 3.751171388588098*^9}, 
   3.751171434494691*^9, {3.7511714956238203`*^9, 3.7511715017615833`*^9}, {
   3.7511718370117702`*^9, 3.75117185299568*^9}, {3.751171957665936*^9, 
   3.751171957917994*^9}, 3.7511721291373997`*^9},
 CellLabel->"In[49]:=",
 CellID->1298720376,ExpressionUUID->"fb6db71e-4c65-4ff7-95a1-2010b6ca5f99"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data Output: Exporting and Polished Plots", "Chapter",
 CellChangeTimes->{{3.725285986222968*^9, 3.725286001833995*^9}, {
  3.725286463538486*^9, 3.7252864786965933`*^9}},
 CellID->94323667],

Cell[CellGroupData[{

Cell["Exporting Data", "Section",
 CellChangeTimes->{{3.7252865363120766`*^9, 3.7252865544547086`*^9}},
 CellID->165523519],

Cell[CellGroupData[{

Cell[TextData[{
 "Suppose you\[CloseCurlyQuote]re trying to output a file which contains the \
data you\[CloseCurlyQuote]ve generated using GCascades. First, we make a list \
of ordered pairs consisting of gamma-ray energies and ",
 Cell[BoxData[
  FormBox[
   FractionBox["dN", 
    SubscriptBox["dE", "\[Gamma]"]], TraditionalForm]]],
 " at those energies using the \[OpenCurlyDoubleQuote]thread\
\[CloseCurlyDoubleQuote] function. Then, we add to the beginning of that list \
a pair of informative data labels. Finally, the \[OpenCurlyDoubleQuote]",
 StyleBox["Export", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] function is used to export this list into a \
\[OpenCurlyDoubleQuote].csv\[CloseCurlyDoubleQuote] file which can be read \
universally. The code below uses the \[OpenCurlyDoubleQuote]",
 StyleBox["Export", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] function which takes in two arguments, the first \
is the location and name of the file including the intended extension, the \
second is the data to export. Note that the location for export is set to use \
\[OpenCurlyDoubleQuote]NotebookDirectory\[CloseCurlyDoubleQuote], which is \
the location of GCascade. To change this, simply replace the first argument \
with a valid file location which can be inserted using the \
\[OpenCurlyDoubleQuote]Insert > File Path\[CloseCurlyDoubleQuote] \
functionality in the menu above. "
}], "Subsection",
 CellChangeTimes->{{3.7252865632680464`*^9, 3.725286883628583*^9}, {
  3.725287313108186*^9, 3.725287503237442*^9}, {3.7314477448334084`*^9, 
  3.7314477485512943`*^9}, {3.731451940329068*^9, 3.731451940375191*^9}, {
  3.731451998440583*^9, 3.731452052660751*^9}},
 CellID->218802140],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{"energies", ",", "pointSourceSpectrum"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{"data", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Gamma-Ray Energy (GeV)\>\"", ",", 
       "\"\<Differential Spectrum dN/dE (GeV^-1 cm^-2 S^-1)\>\""}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<spectralDataExample.csv\>\""}], "}"}], "]"}], ",", "data"}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.725286895254767*^9, 3.7252869078029876`*^9}, {
   3.72528693947861*^9, 3.7252871308579793`*^9}, {3.7252872341183105`*^9, 
   3.725287295656459*^9}, 3.7314519825864286`*^9, {3.736557467560384*^9, 
   3.736557474656399*^9}, {3.7374673648978148`*^9, 3.737467386439165*^9}, {
   3.7374677978256807`*^9, 3.737467801028471*^9}},
 CellID->379863837]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The \[OpenCurlyDoubleQuote]Show\[CloseCurlyDoubleQuote] Function", \
"Section",
 CellChangeTimes->{{3.725286033306157*^9, 3.7252860444014015`*^9}},
 CellID->809985943],

Cell[CellGroupData[{

Cell[TextData[{
 "The \[OpenCurlyDoubleQuote]",
 StyleBox["Show", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] function can be used to display and format any of \
the \[OpenCurlyDoubleQuote]",
 StyleBox["Plot", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] primitives created in the previous examples. In \
the code below, we display the cascades point source spectrum, \
\[OpenCurlyDoubleQuote]",
 StyleBox["pointSourceSpectrumPlot", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote], which is the first argument for the function \
\[OpenCurlyDoubleQuote]",
 StyleBox["Show", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote]. The proceeding arguments may also be changed in \
order to change aspects of the frame. Form more information about \
\[OpenCurlyDoubleQuote]",
 StyleBox["Show", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] or \[OpenCurlyDoubleQuote]",
 StyleBox["Plot", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote], use the Wolfram Mathematica documentation search \
function which can be found under the \[OpenCurlyDoubleQuote]help\
\[CloseCurlyDoubleQuote] tab in the menu above."
}], "Subsection",
 CellChangeTimes->{{3.725286052605124*^9, 3.7252862397028036`*^9}},
 CellID->1870201],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ticks", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SuperscriptBox["10", "x"], ",", 
                SuperscriptBox["\"\<10\>\"", 
                 RowBox[{"ToString", "[", "x", "]"}]]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "]"}], ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"y", "*", 
                   SuperscriptBox["10", "x"]}], ",", "\"\<\>\""}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "2", ",", "9"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "]"}], ",", 
              "1"}], "]"}]}], "}"}], ",", "1"}], "]"}], ",", "None"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
              "0.1", " ", ",", 
               "\"\<\!\(\*SuperscriptBox[\(10\), \(\(\\\ \)\(-1\)\)]\)\>\""}],
               "}"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1", " ", ",", "\"\<1\>\""}], "}"}], "}"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SuperscriptBox["10", "x"], ",", 
                SuperscriptBox["\"\<10\>\"", 
                 RowBox[{"ToString", "[", "x", "]"}]]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "1", ",", "12", ",", "1"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"y", "*", 
                   SuperscriptBox["10", "x"]}], ",", "\"\<\>\""}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "2", ",", "9"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "]"}], ",", 
              "1"}], "]"}]}], "}"}], ",", "1"}], "]"}], "\[IndentingNewLine]",
         ",", "None"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"energies", ",", 
          RowBox[{
           SuperscriptBox["energies", "2"], "attenuatedSpectrum"}]}], "}"}], 
        "]"}], "]"}], "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       SuperscriptBox["10", 
        RowBox[{"-", "1"}]], ",", 
       SuperscriptBox["10", "12"]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.1", ",", 
          SuperscriptBox["10", "6"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Thick"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameTicks", "\[Rule]", "ticks"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p2", "=", 
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"energies", ",", 
           RowBox[{
            SuperscriptBox["energies", "2"], "pointSourceSpectrum"}]}], "}"}],
          "]"}], "]"}], "[", "x", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "1"}]], ",", 
        SuperscriptBox["10", "12"]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1", ",", 
           SuperscriptBox["10", "6"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "11"}]], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "8"}]]}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Blue", ",", "Thick"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameTicks", "\[Rule]", "ticks"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"p2", ",", "p1", ",", "\[IndentingNewLine]", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameStyle", "\[Rule]", " ", 
    RowBox[{"Thickness", "[", "0.004", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameTicksStyle", "\[Rule]", " ", 
    RowBox[{"Thickness", "[", "0.004", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[SubscriptBox[\(E\), \(\[Gamma]\)], \
\(2\)]\)dN/\!\(\*SubscriptBox[\(dE\), \(\[Gamma]\)]\) (GeV \
\!\(\*SuperscriptBox[\(cm\), \(-2\)]\) \!\(\*SuperscriptBox[\(s\), \(-1\)]\))\
\>\"", ",", "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(\[Gamma]\)]\) (GeV)\>\"", ",", 
        "None"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"LabelStyle", "\[Rule]", " ", 
    RowBox[{"Directive", "[", 
     RowBox[{"Bold", ",", "Black", ",", 
      RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Helvetica\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", " ", "14"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.7243776259565887`*^9, {3.7243778853135786`*^9, 3.724377905116062*^9}, {
   3.7243780209861803`*^9, 3.7243780659464836`*^9}, {3.724380172322147*^9, 
   3.7243802074196215`*^9}, 3.7243806126073537`*^9, {3.724380718792102*^9, 
   3.7243807219687138`*^9}, {3.7243807698972726`*^9, 
   3.7243807906668377`*^9}, {3.724430131910561*^9, 3.7244301324415197`*^9}, {
   3.72443284509657*^9, 3.724432858569062*^9}, {3.7244338174271803`*^9, 
   3.7244338189751477`*^9}, {3.7244342211161633`*^9, 3.724434221413102*^9}, {
   3.72443596172503*^9, 3.724435962279344*^9}, {3.724436078004608*^9, 
   3.7244360886400213`*^9}, {3.724436785591798*^9, 3.724437402785071*^9}, {
   3.7244375210994596`*^9, 3.7244375328592577`*^9}, {3.724438496577916*^9, 
   3.7244385409549522`*^9}, {3.7250410230203247`*^9, 
   3.7250410518791585`*^9}, {3.7250564991283035`*^9, 3.7250565901693172`*^9}, 
   3.725286132582053*^9, 3.7252875389442973`*^9, 3.7268577721997604`*^9, {
   3.726857808684019*^9, 3.7268578170893145`*^9}, {3.726857854807129*^9, 
   3.7268580787085643`*^9}, {3.7268585176834345`*^9, 
   3.7268585282724333`*^9}, {3.7268585974404955`*^9, 
   3.7268586295207043`*^9}, {3.7268589288622084`*^9, 3.726858944863634*^9}, {
   3.7268593716692147`*^9, 3.7268594557850647`*^9}, {3.726861664937642*^9, 
   3.726861779583939*^9}, {3.726861813019782*^9, 3.7268618949726653`*^9}, {
   3.72686212571367*^9, 3.72686234057664*^9}, {3.726862445793312*^9, 
   3.726862474055211*^9}, 3.7268625184554124`*^9, {3.7268626228903494`*^9, 
   3.7268627731570463`*^9}, {3.72686281769722*^9, 3.7268628811432967`*^9}, {
   3.726862928622958*^9, 3.7268629374787436`*^9}, {3.7298864322822127`*^9, 
   3.729886472357792*^9}, 3.7298865082888165`*^9, {3.7298866160011444`*^9, 
   3.729886623184512*^9}, {3.7298866678371663`*^9, 3.7298866810737123`*^9}, {
   3.7298867423028507`*^9, 3.729886807861002*^9}, {3.72988723798293*^9, 
   3.729887240504403*^9}, {3.7298906787869225`*^9, 3.729890703817034*^9}, {
   3.7298907414506307`*^9, 3.729890744359573*^9}, {3.7298908443929133`*^9, 
   3.7298908806834755`*^9}, {3.7298910222402973`*^9, 
   3.7298910224823236`*^9}, {3.7298910823390245`*^9, 
   3.7298911172787676`*^9}, {3.7298911893446693`*^9, 
   3.7298911897022333`*^9}, {3.7299131375487814`*^9, 
   3.7299132203463726`*^9}, {3.7299132722195854`*^9, 
   3.7299133662263994`*^9}, {3.729913480437415*^9, 3.729913482322739*^9}, 
   3.730207939409786*^9, {3.7302079753958697`*^9, 3.7302079909211416`*^9}, {
   3.7302080832482796`*^9, 3.7302081791702423`*^9}, {3.7302082296563873`*^9, 
   3.730208243312564*^9}, {3.730208451598036*^9, 3.7302085023040886`*^9}, {
   3.730208602283304*^9, 3.7302086052094235`*^9}, {3.7311066826849594`*^9, 
   3.731106713861102*^9}, {3.7311067550613885`*^9, 3.7311068363556547`*^9}, {
   3.7311068787897553`*^9, 3.731106898233818*^9}, {3.731108821075424*^9, 
   3.731108840129782*^9}, 3.731109078311664*^9, {3.7311091661396103`*^9, 
   3.731109176034822*^9}, {3.7311576038740425`*^9, 3.7311577061209106`*^9}, {
   3.731157950504712*^9, 3.7311579704718027`*^9}, {3.7313505806357365`*^9, 
   3.7313506043558073`*^9}, {3.7313506780928693`*^9, 3.731350759308818*^9}, {
   3.7314134982443905`*^9, 3.731413525394582*^9}, {3.7314482261804447`*^9, 
   3.7314482382194557`*^9}, 3.731448307603217*^9, {3.731452134337926*^9, 
   3.731452155468133*^9}, {3.731452190846178*^9, 3.731452191578124*^9}, {
   3.7356736611485696`*^9, 3.7356736706940565`*^9}, {3.7356886518731203`*^9, 
   3.7356886595376062`*^9}, {3.7356887151313763`*^9, 
   3.7356887155944605`*^9}, {3.735830070922203*^9, 3.7358300829248085`*^9}, {
   3.735865358308464*^9, 3.735865376866975*^9}, {3.73586546714151*^9, 
   3.735865467377345*^9}, {3.7358744695223885`*^9, 3.735874499946562*^9}, 
   3.735874540417596*^9, {3.735967523258369*^9, 3.7359675260242414`*^9}, 
   3.735967566234417*^9, {3.7365483396165857`*^9, 3.7365483442601643`*^9}, {
   3.736550193488392*^9, 3.73655033424799*^9}, {3.736552773205906*^9, 
   3.7365528071520844`*^9}, {3.7365539095620146`*^9, 3.736553940218992*^9}, {
   3.7365575087830935`*^9, 3.7365575192121916`*^9}, {3.7365591634540854`*^9, 
   3.736559165604334*^9}, {3.7373130797038116`*^9, 3.737313125737836*^9}, {
   3.737380487669223*^9, 3.737380560192876*^9}},
 CellID->231790629]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Advanced: Changing the Magnetic field", "Section",
 CellChangeTimes->{{3.7258064679220734`*^9, 3.725806504617673*^9}},
 CellID->34367459],

Cell[CellGroupData[{

Cell[TextData[{
 "While the intergalactic magnetic field is set by default to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "=", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "13"}]], "G"}]}], TraditionalForm]]],
 " is is possible to change this value. However, due to the nature of the \
calculation, GCascade needs to reproduce all of its libraries in order to \
effect this change. This process will take around 30 minutes to complete. \
After the process is complete, you will need to open the package file and \
change the name of the libraries by changing the string \
\[OpenCurlyDoubleQuote]",
 StyleBox["libraryNames", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] found directly under the variable \
\[OpenCurlyDoubleQuote]",
 StyleBox["libraryLocation", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] which you\[CloseCurlyQuote]ve already customized. \
GCascade provides the function \[OpenCurlyDoubleQuote]",
 StyleBox["changeMagneticField", "Input",
  FontSize->16],
 "\[CloseCurlyDoubleQuote] which changes the magnetic field and produces the \
new libraries. the first argument is the magnetic field in Gauss and the \
second is a string which will be prepended to the default \
\[OpenCurlyDoubleQuote]",
 StyleBox["libraryNames\[CloseCurlyDoubleQuote]", "Input",
  FontSize->16],
 " string during export. Thus the final name of the libraries will start with \
 whatever you pass as the second argument making it simple to change  \
\[OpenCurlyDoubleQuote]",
 StyleBox["libraryNames\[CloseCurlyDoubleQuote]", "Input",
  FontSize->16],
 " in the package file by simply adding this string to the beginning. Finally \
you must import the package once again in order to have working functionality \
with the new magnetic field. It should be noted that changing the magnetic \
field to anything under about 0.1 nG will leave the calculation done here \
largely unchanged and will only affect the highest energies, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "e"], ">", 
    RowBox[{
     SuperscriptBox["10", "19"], "eV"}]}], TraditionalForm]]],
 ". Thus, in general, it is not recommended to change the magnetic field.  "
}], "Subsection",
 CellChangeTimes->{{3.7258065130049925`*^9, 3.725806651280905*^9}, {
  3.7258069341705933`*^9, 3.725807016848576*^9}, {3.725807106591369*^9, 
  3.725807476774333*^9}, {3.7258081014816027`*^9, 3.7258082240397143`*^9}, {
  3.7314477504423513`*^9, 3.7314477505917196`*^9}},
 CellID->35518081],

Cell[BoxData[
 RowBox[{"changeMagneticField", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "10"}]], ",", "\"\<Test\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.725382175508709*^9, 3.725382226021103*^9}, {
   3.725382643098403*^9, 3.725382645056896*^9}, {3.72538332354777*^9, 
   3.7253833248512506`*^9}, {3.725807762897604*^9, 3.7258077633729243`*^9}, 
   3.725808239318348*^9, {3.7258085468215275`*^9, 3.725808547604627*^9}, 
   3.725808821217619*^9, {3.7258096044093895`*^9, 3.7258096050230217`*^9}},
 CellID->106654732],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["At this point you would go into the package \
\[OpenCurlyDoubleQuote].wl\[CloseCurlyDoubleQuote] file and change \
\[OpenCurlyDoubleQuote]", "Subsection"],
 StyleBox["libraryNames", "Input",
  FontSize->16],
 StyleBox["\[CloseCurlyDoubleQuote]", "Subsection",
  FontSize->16],
 StyleBox[" from the default \[OpenCurlyDoubleQuote]DiffCascadeSpectralTable\
\[CloseCurlyDoubleQuote] to \
\[OpenCurlyDoubleQuote]TestDiffCascadeSpectralTable\[CloseCurlyDoubleQuote] \
and save the file. Then, you would need to rerun the import command \
\[OpenCurlyDoubleQuote]<<GCascadeV2.wl\[CloseCurlyDoubleQuote] before running \
any new calculations with the new magnetic field.", "Subsection"]
}], "Subsubsection",
 CellChangeTimes->{{3.7258074947331467`*^9, 3.7258076629727545`*^9}, {
  3.7258078227679024`*^9, 3.7258078304282856`*^9}, {3.7314135721509123`*^9, 
  3.7314135783313365`*^9}, {3.7374675618110933`*^9, 3.7374675656172295`*^9}},
 CellID->302659897],

Cell[BoxData[
 RowBox[{"<<", "GCascadeV2.wl"}]], "Input",
 CellChangeTimes->{{3.7258076573557873`*^9, 3.7258076591676083`*^9}, {
  3.731413563884925*^9, 3.731413603993905*^9}, {3.737467558554699*^9, 
  3.7374675590545845`*^9}},
 CellID->65836038]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Evaluator->"Local",
WindowSize->{1280, 1327},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
TaggingRules->{"$testsRun" -> False},
Magnification:>1.3 Inherited,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->FrontEnd`FileName[{"MUnit"}, "MUnit.nb", CharacterEncoding -> 
  "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 309, 4, 127, "Title",ExpressionUUID->"da265509-a8d4-4324-8bfe-425a1de32681",
 CellID->99529794],
Cell[CellGroupData[{
Cell[914, 30, 953, 14, 373, "Subchapter",ExpressionUUID->"506d7f65-6c60-49bb-b6b2-ea2c9ca444b2",
 CellID->169207782],
Cell[CellGroupData[{
Cell[1892, 48, 285, 6, 97, "Section",ExpressionUUID->"d31c9ffc-8199-445a-895c-21c1dd331ea7",
 CellID->95071794],
Cell[CellGroupData[{
Cell[2202, 58, 612, 10, 141, "Subsection",ExpressionUUID->"0d528ea2-49ee-4558-8bd6-ce2aac46b28f",
 CellID->4253156],
Cell[2817, 70, 550, 13, 40, "Input",ExpressionUUID->"f6e72b46-c8f6-4a8e-980e-f164c99da359",
 CellID->9425827]
}, Open  ]],
Cell[CellGroupData[{
Cell[3404, 88, 928, 15, 141, "Subsection",ExpressionUUID->"b03fa9bc-ed56-4b40-86c9-50c8c7eb6a91",
 CellID->476640968],
Cell[4335, 105, 1508, 21, 40, "Input",ExpressionUUID->"8057e53b-7388-4904-ab2c-f9c4f3fa4cd5",
 CellID->26431907]
}, Open  ]]
}, Open  ]],
Cell[5870, 130, 264, 3, 97, "Section",ExpressionUUID->"1516cf4e-a82f-41f7-ae3a-8277cdefb687",
 CellID->256563983],
Cell[CellGroupData[{
Cell[6159, 137, 178, 2, 67, "Section",ExpressionUUID->"5dc9e800-2eec-4c84-b09d-d55aadd46a5d",
 CellID->43342969],
Cell[CellGroupData[{
Cell[6362, 143, 5124, 132, 515, "Subsection",ExpressionUUID->"1d4eb0a3-2358-404f-b181-7623bf1aea36",
 CellID->247095694],
Cell[11489, 277, 1671, 33, 74, "Input",ExpressionUUID->"0d645c86-0079-4ccb-9a18-be60e3953066",
 CellID->226848316]
}, Open  ]],
Cell[CellGroupData[{
Cell[13197, 315, 1182, 29, 188, "Subsection",ExpressionUUID->"aacf565e-7761-4c91-91fe-f0737ec436d3",
 CellID->113528703],
Cell[14382, 346, 477, 8, 40, "Input",ExpressionUUID->"ca0ff386-42a9-404a-a96f-61698ee85911",
 CellID->92325888]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14908, 360, 116, 2, 86, "Section",ExpressionUUID->"92ee3a23-05f6-4d09-9023-12702144f580",
 CellID->297973296],
Cell[CellGroupData[{
Cell[15049, 366, 5645, 150, 526, "Subsection",ExpressionUUID->"77684371-9601-4f15-a172-4f3a6dfe6f1f",
 CellID->22936097],
Cell[20697, 518, 2408, 37, 70, "Input",ExpressionUUID->"ddf2b636-0562-49b6-8fd6-522a2cfb47d8",
 CellID->370012094]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23154, 561, 190, 3, 86, "Section",ExpressionUUID->"c53cea08-c88c-46dd-b3c0-c229b5d7f88d",
 CellID->243349693],
Cell[CellGroupData[{
Cell[23369, 568, 4743, 111, 496, "Subsection",ExpressionUUID->"b514389b-3819-4c09-957c-80e55adefe77",
 CellID->79685355],
Cell[28115, 681, 2394, 40, 99, "Input",ExpressionUUID->"7482f063-9516-428f-921a-e987e5a61aa3",
 CellID->361323213]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30558, 727, 339, 6, 136, "Section",ExpressionUUID->"e2ee105f-5f8e-4c81-9f05-598ef6ca1163",
 CellID->20797861],
Cell[CellGroupData[{
Cell[30922, 737, 9663, 222, 1136, "Subsection",ExpressionUUID->"ef4078cd-9d91-4348-bbd5-a66f833326c2",
 CellID->234064909],
Cell[40588, 961, 6673, 119, 249, "Input",ExpressionUUID->"2931d7d1-b94f-4f65-ad2f-7fde3752327c",
 CellID->523388465]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47310, 1086, 337, 6, 86, "Section",ExpressionUUID->"3d3cb475-3bb4-40e6-b5b7-37172e34fa49",
 CellID->926635129],
Cell[CellGroupData[{
Cell[47672, 1096, 10792, 254, 1293, "Subsection",ExpressionUUID->"a17cc100-a9e1-4899-bd42-6762f4beb86a",
 CellID->1195575519],
Cell[58467, 1352, 7759, 143, 316, "Input",ExpressionUUID->"fb6db71e-4c65-4ff7-95a1-2010b6ca5f99",
 CellID->1298720376]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66287, 1502, 196, 3, 91, "Chapter",ExpressionUUID->"0a9d5c32-11c6-42c9-96c7-b08c8b9d735f",
 CellID->94323667],
Cell[CellGroupData[{
Cell[66508, 1509, 123, 2, 86, "Section",ExpressionUUID->"3412d641-7d3d-415b-991f-7694f65c3566",
 CellID->165523519],
Cell[CellGroupData[{
Cell[66656, 1515, 1714, 31, 372, "Subsection",ExpressionUUID->"99198e29-25e2-46c9-86a4-162e1feda731",
 CellID->218802140],
Cell[68373, 1548, 1125, 30, 99, "Input",ExpressionUUID->"06b28bae-af69-46d0-9fda-46a245151def",
 CellID->379863837]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69547, 1584, 173, 3, 86, "Section",ExpressionUUID->"ba81e629-9785-410c-8761-4f81ad41b0a8",
 CellID->809985943],
Cell[CellGroupData[{
Cell[69745, 1591, 1235, 30, 247, "Subsection",ExpressionUUID->"2d40483f-8747-4da8-b17a-62a777723651",
 CellID->1870201],
Cell[70983, 1623, 10957, 238, 859, "Input",ExpressionUUID->"c29e1a8d-5497-4a14-aeb2-e12beb301a26",
 CellID->231790629]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81989, 1867, 143, 2, 86, "Section",ExpressionUUID->"c51129ff-5769-41b7-8eb5-4f51f1484bb4",
 CellID->34367459],
Cell[CellGroupData[{
Cell[82157, 1873, 2484, 52, 529, "Subsection",ExpressionUUID->"48824456-8a57-463f-adc0-2e4c2c6e3adc",
 CellID->35518081],
Cell[84644, 1927, 538, 10, 44, "Input",ExpressionUUID->"53f2403b-5823-4a79-b6a3-f5bf4887d7c7",
 CellID->106654732],
Cell[CellGroupData[{
Cell[85207, 1941, 972, 18, 166, "Subsubsection",ExpressionUUID->"bb067c8e-a89a-4dce-a537-a0cb2e1e578a",
 CellID->302659897],
Cell[86182, 1961, 246, 5, 40, "Input",ExpressionUUID->"dcd711d0-a1ef-4881-a2c5-ae9abe6e2dc8",
 CellID->65836038]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

